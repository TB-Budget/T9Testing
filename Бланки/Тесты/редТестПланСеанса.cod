--{{ Т9_Тесты - проект для тестирования проектов, созданных на платформе Т9 (c) ТБ.Бюджет, 2015

--Данный проект является свободным программным обеспечением. Вы вправе распространять его
--и/или модифицировать в соответствии с условиями версии 2.1 либо по вашему выбору с условиями
--более поздней версии Стандартной Общественной Лицензии Ограниченного Применения GNU,
--опубликованной Free Software Foundation.

--Мы распространяем этот проект в надежде на то, что он будет вам полезен, однако
--НЕ ПРЕДОСТАВЛЯЕМ НА НЕГО НИКАКИХ ГАРАНТИЙ, в том числе ГАРАНТИИ ТОВАРНОГО СОСТОЯНИЯ ПРИ ПРОДАЖЕ
--и ПРИГОДНОСТИ ДЛЯ ИСПОЛЬЗОВАНИЯ В КОНКРЕТНЫХ ЦЕЛЯХ. Для получения более подробной информации
--ознакомьтесь со Стандартной Общественной Лицензией Ограниченного Применений GNU.

--Вместе с данным проектом вы должны были получить экземпляр Стандартной Общественной Лицензии
--Ограниченного Применения GNU. Если вы его не получили, сообщите об этом в Software Foundation, Inc.,
--59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
--}

class inherited СИС2.БазовыйБланкРедактор "Тест-план сеанса тестирования", editor ТестПланСеанса;

import СИС2 classes Функции;

  inobject private

  var секцСценарийЗаголовокТаблицы: TemplateSection;
  var секцСценарий: TemplateSection;
  var NN: integer[] = $;

--{{ Вспомогательные методы
--}}

--{{ Обработчики событий шаблона
--}}

--{{ Обработчики событий клеток шаблона

  func Поле_ПриНажатии (Cell: TemplateCell; Action: Template.ClickTypes): Logical;
    var локЗаписьТестПлана: Т9_Тесты.ТестПланКласса;
    var locCrd: CardForm;
    var Index: integer;
    if (Cell.Contents = '+') and (Cell.Owner = секцСценарийЗаголовокТаблицы):--{ добавление тест-плана класса в тест-план из заголовка таблицы
      locCrd = Тесты.картТестПланКласса.Create;
      if CmOk = locCrd.ShowEx(локЗаписьТестПлана, 'not ЭтоШаблон', Window.ModalWindow):
        with ТестПП.Insert(1) do
          ТестПланКласса = локЗаписьТестПлана;
        end;
      fi;
      --}
    elsif (Cell.Contents = '+') and (Cell.Owner = секцСценарий):--{ добавление тест-плана класса в тест-план из строки таблицы
      locCrd = Тесты.картТестПланКласса.Create;
      if CmOk = locCrd.ShowEx(локЗаписьТестПлана, 'not ЭтоШаблон', Window.ModalWindow):
        Index = Cell.Frame;
        with ТестПП.Insert(Index + 1) do
          ТестПланКласса = локЗаписьТестПлана;
        end;
      fi;
      --}
    elsif (Cell.Contents = '-') and (Cell.Owner = секцСценарий):--{ удаление строки из тест-плана (без удаления тест-плана класса из справочника)
      ТестПП.Delete(Index);
      --}
    -- перемещение строк
    elsif (Cell.Contents = '5') and (Cell.Owner = секцСценарий):--{ вверх
      Cell.SetFocus;
      if (Cell.Frame > 1):
        секцСценарий.FrameUp(Cell.Frame);
      fi;--}
    elsif (Cell.Contents = '6') and (Cell.Owner = секцСценарий):--{ вниз
      Cell.SetFocus;
      if (Cell.Frame < секцСценарий.FramesCount):
        секцСценарий.FrameDown(Cell.Frame);
      fi;--}
    -- карточка тест-плана класса
    elsif (Cell.Contents = '...') and (Cell.Owner = секцСценарий):--{
      Index = Cell.Frame;
      локЗаписьТестПлана = ТестПП[Index].ТестПланКласса;
      if (локЗаписьТестПлана <> nil):
        OpenBlankEditor('Тесты.редТестПланКласса', локЗаписьТестПлана,  Window.ModalWindow);
      else
        Message('Ошибка. Тест-план класса был удален нештатным способом.');
      fi;--}
    fi;
  end;

--}}

--{{ Обработчики событий прочих объектов шаблона
--}}

end